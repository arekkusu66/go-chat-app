package pages

import "gochat/db"
import "fmt"
import "context"


css Notifications() {
    width: 300px;
    height: 100px;
    position: absolute;
    top: 0;
    right: 0;
    padding: 10px;
}


css unreadNotif() {
    background-color: rgba(255, 0, 0, 0.5);
}


templ UserNotifications(ctx context.Context, user db.User) {
    <script src="/script/notifclient.js" defer></script>
    <script src="/script/scripts.js" defer></script>

    {{ unreadNotifsExist, _ := db.Query.AreThereUnreadNotifications(ctx, user.ID) }}

    <div id="notifications" class={Notifications(), templ.KV(unreadNotif(), unreadNotifsExist)}>
        <button onclick="showNotifications()">Show</button>

        <p>
            Notifications
            <b id="notif-count">

                {{ count, _ := db.Query.UnreadNotificationsCount(ctx, user.ID) }}
                
                if count != 0 {
                    {fmt.Sprint(count)}
                }
            </b>
        </p>

        <div id="notif-c"></div>
    </div>
}